<div class='mt-3'>
   <h3>Khóa học đã xóa</h3>

   <table class='table'>
      <thead>
         <tr>
            <th scope='col'>#</th>
            <th scope='col'>Tên khóa học</th>
            <th scope='col'>Mô tả</th>
            <th scope='col' colspan='2'>Thời gian tạo</th>
         </tr>
      </thead>
      <tbody>
         {{#each courses}}
            <tr>
               <th scope='row'>{{sum @index 1}}</th>
               <td>{{this.name}}</td>
               <td>{{this.description}}</td>
               <td>{{this.createdAt}}</td>
               <td>
                  <a href='' class='btn btn-link btn-restore' data-id={{this._id}}>Khôi phục</a>
                  <a
                     type='button'
                     class='btn btn-primary btn-force-delete'
                     data-bs-toggle='modal'
                     data-bs-target='#delete-course-modal'
                     data-id={{this._id}}
                  >Xóa vĩnh viễn</a>
               </td>
            </tr>
         {{else}}
            <tr>
               <td colspan='5' class='text-center'>Thùng rác trống
                  <a href='/me/stored/courses'>Danh sách khóa học</a>
               </td>
            </tr>
         {{/each}}
      </tbody>
   </table>

</div>

{{! Confirm Delete Modal }}

<div id='delete-course-modal' class='modal' tabindex='-1'>
   <div class='modal-dialog'>
      <div class='modal-content'>
         <div class='modal-header'>
            <h5 class='modal-title'>Modal title</h5>
            <button type='button' class='btn-close' data-bs-dismiss='modal' aria-label='Close'></button>
         </div>
         <div class='modal-body'>
            <p>Xác nhận xóa Khóa học</p>
         </div>
         <div class='modal-footer'>
            <button id='btn-delete-course' type='button' class='btn btn-danger'>Xóa bỏ</button>
            <button type='button' class='btn btn-secondary' data-bs-dismiss='modal'>Hủy</button>
         </div>
      </div>
   </div>
</div>

{{! Delete Hidden Form }}

<form name='delete-course-form' method='POST'> </form>
<form name='restore-course-form' method='POST'> </form>

<script src='https://code.jquery.com/jquery-3.6.4.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js'></script>

<script>
   document.addEventListener('DOMContentLoaded', function () {
   const restoreBtn = $('.btn-restore');
   let courseId;
   const deleteForm = document.forms['delete-course-form'];
   const restoreForm = document.forms['restore-course-form'];

   // Khi mở modal "xóa khóa học"
   $('#delete-course-modal').on('show.bs.modal', function (event) {
      const button = $(event.relatedTarget);
      courseId = button.data('id');
      console.log(courseId);
   });

   
   // Nút "Xóa bỏ"
   const btnDeleteCourse = document.getElementById('btn-delete-course');
   btnDeleteCourse.onclick = function () {
      deleteForm.action = `/courses/${courseId}?_method=DELETE`;
      deleteForm.submit();
   };

   // Nút "Xóa bỏ vinh vien"
   const btnForceDeleteCourse = document.getElementById('btn-force-delete');
   btnDeleteCourse.onclick = function () {
      deleteForm.action = `/courses/${courseId}/force?_method=DELETE`;
      deleteForm.submit();
   };


   // Nút "Khôi phục"
   restoreBtn.click(function (e) {
      e.preventDefault();
      const courseId = $(this).data('id');
      restoreForm.action = `/courses/${courseId}/restore?_method=PATCH`;
      restoreForm.submit();
   });
});



</script>